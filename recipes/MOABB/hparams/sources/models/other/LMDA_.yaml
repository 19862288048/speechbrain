# MODEL: LMDA-Net
input_shape: [null, !ref <T>, !ref <C>, null]
cnn_ch_attn_kernels: 9  # @orion_step1: --cnn_ch_attn_kernels~"uniform(4, 64,discrete=True)"
cnn_temporal_kernels: 24  # @orion_step1: --cnn_temporal_kernels~"uniform(4, 64,discrete=True)"
cnn_temporal_kernelsize: 32  # @orion_step1: --cnn_temporal_kernelsize~"uniform(24, 62,discrete=True)"
cnn_spatial_kernels: 9  # @orion_step1: --cnn_spatial_kernels~"uniform(4, 64,discrete=True)"

# cnn_depth_attn_kernelsize_ratio from 1 to 4 with a step of 0.5 (1., 1.5, 2.,..., 3.5, 4.)
# ->cnn_depth_attn_kernelsize_ratio_ from 2 to 8 with a step of 1 then / 2
cnn_depth_attn_kernelsize_ratio_: 7
cnn_depth_attn_kernelsize_ratio: !ref <cnn_depth_attn_kernelsize_ratio_> / 2
cnn_depth_attn_kernelsize: !apply:round
    - !ref <cnn_temporal_kernels> / <cnn_depth_attn_kernelsize_ratio>  # using the original ratio as in the publication (3.5)
cnn_pool: 5  # @orion_step1: --cnn_pool~"uniform(1, 8,discrete=True)"
dropout: 0.1748  # @orion_step1: --dropout~"uniform(0.0, 0.5)"
activation_type: 'gelu'

model: !new:models.LMDA_.LMDA
    chans: !ref <C>
    samples: !ref <T>
    depth: !ref <cnn_ch_attn_kernels>
    kernel: !ref <cnn_temporal_kernelsize>
    channel_depth1: !ref <cnn_temporal_kernels>
    channel_depth2: !ref <cnn_spatial_kernels>
    avepool: !ref <cnn_pool>
    dropout: !ref <dropout>
    num_classes: !ref <n_classes>
