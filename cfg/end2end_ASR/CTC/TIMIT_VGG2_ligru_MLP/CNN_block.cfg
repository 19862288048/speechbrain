[global]
[/global]

[functions]

      [conv2d]
          class_name=speechbrain.nnet.architectures.conv
          out_channels=64
          kernel_size=3
          padding=0
      [/conv2d]

      [conv2d2]
          class_name=speechbrain.nnet.architectures.conv
          out_channels=64
          kernel_size=3
          padding=0
      [/conv2d2]

      [batch_norm_conv]
          class_name=speechbrain.nnet.normalization.normalize
          norm_type = batchnorm
      [/batch_norm_conv]

      [batch_norm_conv2]
          class_name=speechbrain.nnet.normalization.normalize
          norm_type = batchnorm
      [/batch_norm_conv2]

      [activation_conv]
          class_name=speechbrain.nnet.architectures.activation
          act_type=leaky_relu
      [/activation_conv]

      [dropout_conv]
          class_name=speechbrain.nnet.architectures.dropout
          drop_rate=0.15
      [/dropout_conv]

      [pool_conv]
          class_name=speechbrain.nnet.architectures.pooling
          kernel_size=2
          stride=2
          pool_type=max
          pool_dim=1
      [/pool_conv]

      [pool_time]
          class_name=speechbrain.nnet.architectures.pooling
          kernel_size=2
          stride=2
          pool_type=max
          pool_dim=1
          pool_axis=-1
      [/pool_time]

[/functions]


[computations]

    fea,*_=get_input_var()

    out=conv2d(fea)
    out=batch_norm_conv(out)
    out=activation_conv(out)
    out=conv2d2(out)
    out=batch_norm_conv2(out)
    out=activation_conv(out)
    out=pool_conv(out)
    out=pool_time(out)
    out=dropout_conv(out)

[/computations]
